import{f as $,a as D}from"../chunks/D93hUDEI.js";import{i as oe}from"../chunks/BznYoFRY.js";import{p as ue,b0 as Ee,J as s,K as n,I as v,G as q,x as f,B as R,a as ve,o as we,b1 as V,b2 as je,F as ke,A as e,aF as me,aH as r,at as p,a3 as Fe,ap as ie}from"../chunks/DcTAzX_I.js";import{s as N}from"../chunks/hnOH0-N2.js";import{s as ne,b as Ne,T as Oe,e as he,i as xe}from"../chunks/Ijujpeek.js";import{p as I,i as G,b as Re,s as Be,a as Ke}from"../chunks/B944SqXc.js";import{r as ze,s as Ue,l as Je,a as Ie,b as ye}from"../chunks/B0dv8mGB.js";import{e as W}from"../chunks/BpqMFE6l.js";import{g as Ce}from"../chunks/U-3HPdLI.js";var qe=$('<div class="expanded-panel svelte-1fl11k9"><button class="enter-btn-small svelte-1fl11k9">Enter Dojo</button></div>'),Ge=$('<div class="tile-wrapper svelte-1fl11k9"><button class="login-tile svelte-1fl11k9"><div class="login-tile-avatar svelte-1fl11k9"><span class="avatar-initials svelte-1fl11k9"> </span></div> <div class="login-tile-info svelte-1fl11k9"><div class="login-tile-name svelte-1fl11k9"> </div> <div class="belt-pill svelte-1fl11k9"> </div></div></button> <!></div>');function He(B,c){ue(c,!1);let g=I(c,"student",8),S=I(c,"index",8),X=I(c,"expanded",8,!1);const y=Ee(),E=["#1a2232","#1c2638","#1d293d","#202c42","#1b2635","#1e2b44"],k=["#93c5fd","#a5f3fc","#fda4af","#fcd34d","#bbf7d0","#c7d2fe"];function A(a){return E[a%E.length]}function L(a){return k[a%k.length]}function z(a){const l=a.toLowerCase();return l.includes("white")?"#e5e7eb":l.includes("yellow")?"#facc15":l.includes("orange")?"#fb923c":l.includes("green")?"#22c55e":l.includes("blue")?"#3b82f6":l.includes("purple")?"#a855f7":l.includes("brown")?"#92400e":l.includes("red")?"#dc2626":l.includes("black")?"#111827":"#334155"}function C(a){const l=z(a);return new Set(["#111827","#92400e","#dc2626","#334155"]).has(l)?"#f9fafb":"#111827"}function j(a){return a?a.replace(/^(Mr\.?|Ms\.?|Mrs\.?|Miss|Dr\.?)\s+/i,"").trim().split(/\s+/).map(l=>l[0]).join("").slice(0,2).toUpperCase():""}function u(a){return(a?.displayName||a?.name||"Unknown").toString()}oe();var M=Ge(),d=s(M),b=s(d),m=s(b),F=s(m,!0);n(m),n(b);var w=v(b,2),P=s(w),K=s(P,!0);n(P);var O=v(P,2),T=s(O,!0);n(O),n(w),n(d);var H=v(d,2);{var Z=a=>{var l=qe(),h=s(l);n(l),W("click",h,()=>y("enter")),D(a,l)};G(H,a=>{X()&&a(Z)})}n(M),q((a,l,h,Q,ee,Y,U)=>{ne(d,`background:${a??""};border-color:${l??""};`),ne(b,`background:${h??""};`),N(F,Q),N(K,ee),ne(O,`background:${Y??""};color:${U??""};`),N(T,(R(g()),f(()=>g().rank)))},[()=>(R(S()),f(()=>A(S()))),()=>(R(S()),f(()=>A(S()))),()=>(R(S()),f(()=>L(S()))),()=>(R(g()),f(()=>j(u(g())))),()=>(R(g()),f(()=>u(g()))),()=>(R(g()),f(()=>z(g().rank))),()=>(R(g()),f(()=>C(g().rank)))]),W("click",d,()=>y("toggle")),D(B,M),ve()}var Qe=$('<span class="pill svelte-1ppz18g"> </span>'),Ye=$('<span class="pill is3 svelte-1ppz18g"> </span>'),Ve=$('<p class="pin-error svelte-1ppz18g"> </p>'),We=$('<div class="pin-backdrop svelte-1ppz18g"><div class="pin-card svelte-1ppz18g"><div class="avatar svelte-1ppz18g"> </div> <h2 class="pin-title svelte-1ppz18g"> </h2> <p class="pin-subtitle handwritten svelte-1ppz18g"> </p> <div class="pills svelte-1ppz18g"><!> <!></div> <label class="pin-label svelte-1ppz18g" for="pinInput">PIN</label> <input id="pinInput" type="password" class="pin-input svelte-1ppz18g" placeholder="Enter PIN…" maxlength="8"/> <!> <div class="actions svelte-1ppz18g"><button class="btn ghost svelte-1ppz18g">CANCEL</button> <button class="btn ok svelte-1ppz18g">OK</button></div></div></div>');function Se(B,c){ue(c,!1);let g=I(c,"title",8,""),S=I(c,"subtitle",8,""),X=I(c,"value",12,""),y=I(c,"pinField",12,null),E=I(c,"pinError",8,""),k=I(c,"avatarInitials",8,""),A=I(c,"avatarColor",8,""),L=I(c,"rank",8,""),z=I(c,"is3Rank",8,"");const C=Ee();function j(){C("cancel")}function u(){C("submit")}we(()=>{y()&&(y().focus(),y().select())});function M(o){o.key==="Enter"&&C("submit")}oe();var d=We(),b=s(d),m=s(b),F=s(m,!0);n(m);var w=v(m,2),P=s(w,!0);n(w);var K=v(w,2),O=s(K,!0);n(K);var T=v(K,2),H=s(T);{var Z=o=>{var _=Qe(),J=s(_,!0);n(_),q(()=>N(J,L())),D(o,_)};G(H,o=>{L()&&o(Z)})}var a=v(H,2);{var l=o=>{var _=Ye(),J=s(_,!0);n(_),q(()=>N(J,z())),D(o,_)};G(a,o=>{z()&&o(l)})}n(T);var h=v(T,4);ze(h),Re(h,o=>y(o),()=>y());var Q=v(h,2);{var ee=o=>{var _=Ve(),J=s(_,!0);n(_),q(()=>N(J,E())),D(o,_)};G(Q,o=>{E()&&o(ee)})}var Y=v(Q,2),U=s(Y),te=v(U,2);n(Y),n(b),n(d),q(()=>{ne(m,`background: ${A()??""}`),N(F,k()),N(P,g()),N(O,S())}),Ne(h,X),W("keydown",h,M),W("click",U,j),W("click",te,u),D(B,d),ve()}var Xe=$('<div class="instructor-tag svelte-8ukb9p">Instructor Mode Enabled</div>'),Ze=$('<div class="letter-header svelte-8ukb9p"> </div> <!>',1),et=$('<div class="login-wrapper svelte-8ukb9p" style="margin-top: 100px;"><section><!> <header class="login-header svelte-8ukb9p"><h1 class="login-title svelte-8ukb9p">Enter the Dojo</h1> <p class="login-subtitle svelte-8ukb9p">Tap your profile to begin your training journey.</p></header> <!> <div class="login-toolbar svelte-8ukb9p"><input type="text" class="login-search svelte-8ukb9p" placeholder="Search students…"/> <div class="instructor-switch svelte-8ukb9p"><button type="button" aria-label="Toggle Instructor Login"><span class="instructor-thumb svelte-8ukb9p"></span></button> <span class="instructor-label svelte-8ukb9p">Instructor Login</span></div></div> <div class="login-roster-scroll svelte-8ukb9p"><div class="login-grid svelte-8ukb9p"></div></div></section></div> <!> <!>',1);function tt(B,c){ue(c,!1);const g=()=>Ke(Ue,"$students",S),[S,X]=Be(),y=p();let E=p(""),k=p(!1),A=p([]),L=p([]),z=p([]),C=p({}),j=p(null),u=p(null),M=p(0),d=p(!1),b=p(!1),m=p(""),F=p(""),w=p(""),P=p("");const K="8675309";let O=null;const T=["#93c5fd","#a5f3fc","#fda4af","#fcd34d","#bbf7d0","#c7d2fe"];function H(t){return t==null?T[0]:T[t%T.length]}function Z(t){return t?t.replace(/^(Mr\.?|Ms\.?|Mrs\.?|Miss|Dr\.?)\s+/i,"").trim().split(/\s+/).map(i=>i[0]).join("").slice(0,2).toUpperCase():""}function a(t){const x=(t?.displayName||t?.name||"").toString().trim().split(/\s+/).filter(Boolean);return x.length===0?"":x[x.length-1].toUpperCase()}function l(t){r(j,e(j)===t?null:t)}function h(t,i){r(u,t),r(M,i??0),e(k)?(ye(t),Ce("/dashboard",{replaceState:!0})):(r(d,!0),r(m,""),r(w,""))}function Q(){e(u)&&(e(m)===(e(u).pin??"")?(ye(e(u)),r(d,!1),Ce("/dashboard",{replaceState:!0})):r(w,"Incorrect PIN — try again."))}we(()=>{Je().catch(t=>console.error("Failed to load students:",t))});function ee(){if(e(k)){r(k,!1);return}r(F,""),r(P,""),r(b,!0)}function Y(){e(F)===K?(r(k,!0),r(b,!1)):r(P,"Invalid admin PIN.")}V(()=>g(),()=>{r(A,g()||[])}),V(()=>(e(A),e(E)),()=>{r(L,e(A).filter(t=>`${t?.name||""} ${t?.displayName||""}`.toLowerCase().includes(e(E).toLowerCase()))||[])}),V(()=>e(L),()=>{r(z,[...e(L)].sort((t,i)=>a(t).localeCompare(a(i))))}),V(()=>e(z),()=>{r(C,e(z).reduce((t,i)=>{const x=a(i)[0];return t[x]||(t[x]=[]),t[x].push(i),t},{}))}),V(()=>(e(d),e(b),me),()=>{(e(d)||e(b))&&me().then(()=>{})}),V(()=>e(k),()=>{r(y,e(k)?"instructor-active":"")}),je(),oe();var U=et(),te=ke(U),o=s(te),_=s(o);{var J=t=>{var i=Xe();D(t,i)};G(_,t=>{e(k)&&t(J)})}var ce=v(_,4);Oe(ce,{});var se=v(ce,2),le=s(se);ze(le);var de=v(le,2),pe=s(de);Fe(2),n(de),n(se);var fe=v(se,2),ge=s(fe);he(ge,5,()=>(e(C),f(()=>Object.keys(e(C)))),xe,(t,i)=>{var x=Ze(),ae=ke(x),De=s(ae);n(ae);var $e=v(ae,2);he($e,1,()=>(e(C),e(i),f(()=>e(C)[e(i)])),xe,(Ae,re,_e)=>{{let Le=ie(()=>(e(j),e(re),f(()=>e(j)===e(re).id)));He(Ae,{get student(){return e(re)},index:_e,get expanded(){return e(Le)},$$events:{toggle:()=>l(e(re).id),enter:()=>h(e(re),_e)}})}}),q(()=>N(De,`— ${e(i)??""} —`)),D(t,x)}),n(ge),n(fe),n(o),n(te);var be=v(te,2);{var Me=t=>{{let i=ie(()=>(e(u),f(()=>Z(e(u).displayName)))),x=ie(()=>(e(M),f(()=>H(e(M)))));Se(t,{title:"Enter Your PIN",get subtitle(){return e(u),f(()=>e(u).displayName)},pinField:O,get pinError(){return e(w)},get avatarInitials(){return e(i)},get avatarColor(){return e(x)},get rank(){return e(u),f(()=>e(u).rank)},get is3Rank(){return e(u),f(()=>e(u).is3Rank)},get value(){return e(m)},set value(ae){r(m,ae)},$$events:{submit:Q,cancel:()=>r(d,!1)},$$legacy:!0})}};G(be,t=>{e(d)&&e(u)&&t(Me)})}var Pe=v(be,2);{var Te=t=>{Se(t,{title:"Instructor Access",subtitle:"Enter the Dojo Admin PIN.",pinField:O,get pinError(){return e(P)},avatarInitials:"TK",avatarColor:"#38bdf8",rank:"",is3Rank:"",get value(){return e(F)},set value(i){r(F,i)},$$events:{submit:Y,cancel:()=>r(b,!1)},$$legacy:!0})};G(Pe,t=>{e(b)&&t(Te)})}q(()=>{Ie(o,1,`login-card ${e(y)??""}`,"svelte-8ukb9p"),Ie(pe,1,"instructor-toggle "+(e(k)?"is-on":""),"svelte-8ukb9p")}),Ne(le,()=>e(E),t=>r(E,t)),W("click",pe,ee),D(B,U),ve(),X()}function ct(B){tt(B,{})}export{ct as component};
