import"../chunks/DsnmJJEf.js";import"../chunks/69_IOA4Y.js";import{p as ot,aZ as wt,l as s,m as n,s as v,t as J,d as f,f as R,k as ut,aE as Nt,a_ as H,a$ as At,j as kt,g as t,aC as mt,aF as r,aq as p,a3 as Ft,am as it}from"../chunks/Wiajt4P9.js";import{s as S}from"../chunks/CddicKyh.js";import{s as nt,b as St,T as Ot,e as ht,i as xt}from"../chunks/jA6-vvz4.js";import{p as I,i as Q,b as Rt,s as Ut,a as Bt}from"../chunks/BfjrTVym.js";import{f as D,e as V,a as $}from"../chunks/D9b-f7YM.js";import{r as zt,s as Kt,l as qt,a as It,b as yt}from"../chunks/DEhYkdjB.js";import{i as vt}from"../chunks/C1Os28la.js";import{g as Ct}from"../chunks/Bgy1zoV3.js";var Jt=D('<div class="expanded-panel svelte-1fl11k9"><button class="enter-btn-small svelte-1fl11k9">Enter Dojo</button></div>'),Qt=D('<div class="tile-wrapper svelte-1fl11k9"><button class="login-tile svelte-1fl11k9"><div class="login-tile-avatar svelte-1fl11k9"><span class="avatar-initials svelte-1fl11k9"> </span></div> <div class="login-tile-info svelte-1fl11k9"><div class="login-tile-name svelte-1fl11k9"> </div> <div class="belt-pill svelte-1fl11k9"> </div></div></button> <!></div>');function Yt(U,c){ot(c,!1);let g=I(c,"student",8),E=I(c,"index",8),W=I(c,"expanded",8,!1);const y=wt(),w=["#1a2232","#1c2638","#1d293d","#202c42","#1b2635","#1e2b44"],k=["#93c5fd","#a5f3fc","#fda4af","#fcd34d","#bbf7d0","#c7d2fe"];function L(a){return w[a%w.length]}function j(a){return k[a%k.length]}function z(a){const l=a.toLowerCase();return l.includes("white")?"#e5e7eb":l.includes("yellow")?"#facc15":l.includes("orange")?"#fb923c":l.includes("green")?"#22c55e":l.includes("blue")?"#3b82f6":l.includes("purple")?"#a855f7":l.includes("brown")?"#92400e":l.includes("red")?"#dc2626":l.includes("black")?"#111827":"#334155"}function C(a){const l=z(a);return new Set(["#111827","#92400e","#dc2626","#334155"]).has(l)?"#f9fafb":"#111827"}function A(a){return a?a.replace(/^(Mr\.?|Ms\.?|Mrs\.?|Miss|Dr\.?)\s+/i,"").trim().split(/\s+/).map(l=>l[0]).join("").slice(0,2).toUpperCase():""}function u(a){return(a?.displayName||a?.name||"Unknown").toString()}vt();var M=Qt(),d=s(M),b=s(d),m=s(b),F=s(m,!0);n(m),n(b);var N=v(b,2),P=s(N),B=s(P,!0);n(P);var O=v(P,2),T=s(O,!0);n(O),n(N),n(d);var Y=v(d,2);{var X=a=>{var l=Jt(),h=s(l);n(l),V("click",h,()=>y("enter")),$(a,l)};Q(Y,a=>{W()&&a(X)})}n(M),J((a,l,h,Z,tt,G,K)=>{nt(d,`background:${a??""};border-color:${l??""};`),nt(b,`background:${h??""};`),S(F,Z),S(B,tt),nt(O,`background:${G??""};color:${K??""};`),S(T,(R(g()),f(()=>g().rank)))},[()=>(R(E()),f(()=>L(E()))),()=>(R(E()),f(()=>L(E()))),()=>(R(E()),f(()=>j(E()))),()=>(R(g()),f(()=>A(u(g())))),()=>(R(g()),f(()=>u(g()))),()=>(R(g()),f(()=>z(g().rank))),()=>(R(g()),f(()=>C(g().rank)))]),V("click",d,()=>y("toggle")),$(U,M),ut()}var Zt=D('<span class="pill svelte-1ppz18g"> </span>'),Gt=D('<span class="pill is3 svelte-1ppz18g"> </span>'),Ht=D('<p class="pin-error svelte-1ppz18g"> </p>'),Vt=D('<div class="pin-backdrop svelte-1ppz18g"><div class="pin-card svelte-1ppz18g"><div class="avatar svelte-1ppz18g"> </div> <h2 class="pin-title svelte-1ppz18g"> </h2> <p class="pin-subtitle handwritten svelte-1ppz18g"> </p> <div class="pills svelte-1ppz18g"><!> <!></div> <label class="pin-label svelte-1ppz18g" for="pinInput">PIN</label> <input id="pinInput" type="password" class="pin-input svelte-1ppz18g" placeholder="Enter PIN…" maxlength="8"/> <!> <div class="actions svelte-1ppz18g"><button class="btn ghost svelte-1ppz18g">CANCEL</button> <button class="btn ok svelte-1ppz18g">OK</button></div></div></div>');function Et(U,c){ot(c,!1);let g=I(c,"title",8,""),E=I(c,"subtitle",8,""),W=I(c,"value",12,""),y=I(c,"pinField",12,null),w=I(c,"pinError",8,""),k=I(c,"avatarInitials",8,""),L=I(c,"avatarColor",8,""),j=I(c,"rank",8,""),z=I(c,"is3Rank",8,"");const C=wt();function A(){C("cancel")}function u(){C("submit")}Nt(()=>{y()&&(y().focus(),y().select())});function M(o){o.key==="Enter"&&C("submit")}vt();var d=Vt(),b=s(d),m=s(b),F=s(m,!0);n(m);var N=v(m,2),P=s(N,!0);n(N);var B=v(N,2),O=s(B,!0);n(B);var T=v(B,2),Y=s(T);{var X=o=>{var _=Zt(),q=s(_,!0);n(_),J(()=>S(q,j())),$(o,_)};Q(Y,o=>{j()&&o(X)})}var a=v(Y,2);{var l=o=>{var _=Gt(),q=s(_,!0);n(_),J(()=>S(q,z())),$(o,_)};Q(a,o=>{z()&&o(l)})}n(T);var h=v(T,4);zt(h),Rt(h,o=>y(o),()=>y());var Z=v(h,2);{var tt=o=>{var _=Ht(),q=s(_,!0);n(_),J(()=>S(q,w())),$(o,_)};Q(Z,o=>{w()&&o(tt)})}var G=v(Z,2),K=s(G),et=v(K,2);n(G),n(b),n(d),J(()=>{nt(m,`background: ${L()??""}`),S(F,k()),S(P,g()),S(O,E())}),St(h,W),V("keydown",h,M),V("click",K,A),V("click",et,u),$(U,d),ut()}var Wt=D('<div class="instructor-tag svelte-8ukb9p">Instructor Mode Enabled</div>'),Xt=D('<div class="letter-header svelte-8ukb9p"> </div> <!>',1),te=D('<div class="login-wrapper svelte-8ukb9p" style="margin-top: 100px;"><section><!> <header class="login-header svelte-8ukb9p"><h1 class="login-title svelte-8ukb9p">Enter the Dojo</h1> <p class="login-subtitle svelte-8ukb9p">Tap your profile to begin your training journey.</p></header> <!> <div class="login-toolbar svelte-8ukb9p"><input type="text" class="login-search svelte-8ukb9p" placeholder="Search students…"/> <div class="instructor-switch svelte-8ukb9p"><button type="button" aria-label="Toggle Instructor Login"><span class="instructor-thumb svelte-8ukb9p"></span></button> <span class="instructor-label svelte-8ukb9p">Instructor Login</span></div></div> <div class="login-roster-scroll svelte-8ukb9p"><div class="login-grid svelte-8ukb9p"></div></div></section></div> <!> <!>',1);function ee(U,c){ot(c,!1);const g=()=>Bt(Kt,"$students",E),[E,W]=Ut(),y=p();let w=p(""),k=p(!1),L=p([]),j=p([]),z=p([]),C=p({}),A=p(null),u=p(null),M=p(0),d=p(!1),b=p(!1),m=p(""),F=p(""),N=p(""),P=p("");const B="8675309";let O=null;const T=["#93c5fd","#a5f3fc","#fda4af","#fcd34d","#bbf7d0","#c7d2fe"];function Y(e){return e==null?T[0]:T[e%T.length]}function X(e){return e?e.replace(/^(Mr\.?|Ms\.?|Mrs\.?|Miss|Dr\.?)\s+/i,"").trim().split(/\s+/).map(i=>i[0]).join("").slice(0,2).toUpperCase():""}function a(e){const x=(e?.displayName||e?.name||"").toString().trim().split(/\s+/).filter(Boolean);return x.length===0?"":x[x.length-1].toUpperCase()}function l(e){r(A,t(A)===e?null:e)}function h(e,i){r(u,e),r(M,i??0),t(k)?(yt(e),Ct("/dashboard")):(r(d,!0),r(m,""),r(N,""))}function Z(){t(u)&&(t(m)===(t(u).pin??"")?(yt(t(u)),r(d,!1),Ct("/dashboard")):r(N,"Incorrect PIN — try again."))}Nt(()=>{qt().catch(e=>console.error("Failed to load students:",e))});function tt(){if(t(k)){r(k,!1);return}r(F,""),r(P,""),r(b,!0)}function G(){t(F)===B?(r(k,!0),r(b,!1)):r(P,"Invalid admin PIN.")}H(()=>g(),()=>{r(L,g()||[])}),H(()=>(t(L),t(w)),()=>{r(j,t(L).filter(e=>`${e?.name||""} ${e?.displayName||""}`.toLowerCase().includes(t(w).toLowerCase()))||[])}),H(()=>t(j),()=>{r(z,[...t(j)].sort((e,i)=>a(e).localeCompare(a(i))))}),H(()=>t(z),()=>{r(C,t(z).reduce((e,i)=>{const x=a(i)[0];return e[x]||(e[x]=[]),e[x].push(i),e},{}))}),H(()=>(t(d),t(b),mt),()=>{(t(d)||t(b))&&mt().then(()=>{})}),H(()=>t(k),()=>{r(y,t(k)?"instructor-active":"")}),At(),vt();var K=te(),et=kt(K),o=s(et),_=s(o);{var q=e=>{var i=Wt();$(e,i)};Q(_,e=>{t(k)&&e(q)})}var ct=v(_,4);Ot(ct,{});var st=v(ct,2),lt=s(st);zt(lt);var dt=v(lt,2),pt=s(dt);Ft(2),n(dt),n(st);var ft=v(st,2),gt=s(ft);ht(gt,5,()=>(t(C),f(()=>Object.keys(t(C)))),xt,(e,i)=>{var x=Xt(),at=kt(x),$t=s(at);n(at);var Dt=v(at,2);ht(Dt,1,()=>(t(C),t(i),f(()=>t(C)[t(i)])),xt,(Lt,rt,_t)=>{{let jt=it(()=>(t(A),t(rt),f(()=>t(A)===t(rt).id)));Yt(Lt,{get student(){return t(rt)},index:_t,get expanded(){return t(jt)},$$events:{toggle:()=>l(t(rt).id),enter:()=>h(t(rt),_t)}})}}),J(()=>S($t,`— ${t(i)??""} —`)),$(e,x)}),n(gt),n(ft),n(o),n(et);var bt=v(et,2);{var Mt=e=>{{let i=it(()=>(t(u),f(()=>X(t(u).displayName)))),x=it(()=>(t(M),f(()=>Y(t(M)))));Et(e,{title:"Enter Your PIN",get subtitle(){return t(u),f(()=>t(u).displayName)},pinField:O,get pinError(){return t(N)},get avatarInitials(){return t(i)},get avatarColor(){return t(x)},get rank(){return t(u),f(()=>t(u).rank)},get is3Rank(){return t(u),f(()=>t(u).is3Rank)},get value(){return t(m)},set value(at){r(m,at)},$$events:{submit:Z,cancel:()=>r(d,!1)},$$legacy:!0})}};Q(bt,e=>{t(d)&&t(u)&&e(Mt)})}var Pt=v(bt,2);{var Tt=e=>{Et(e,{title:"Instructor Access",subtitle:"Enter the Dojo Admin PIN.",pinField:O,get pinError(){return t(P)},avatarInitials:"TK",avatarColor:"#38bdf8",rank:"",is3Rank:"",get value(){return t(F)},set value(i){r(F,i)},$$events:{submit:G,cancel:()=>r(b,!1)},$$legacy:!0})};Q(Pt,e=>{t(b)&&e(Tt)})}J(()=>{It(o,1,`login-card ${t(y)??""}`,"svelte-8ukb9p"),It(pt,1,"instructor-toggle "+(t(k)?"is-on":""),"svelte-8ukb9p")}),St(lt,()=>t(w),e=>r(w,e)),V("click",pt,tt),$(U,K),ut(),W()}function de(U){ee(U,{})}export{de as component};
