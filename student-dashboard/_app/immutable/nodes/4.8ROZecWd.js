import{f as $,a as D}from"../chunks/D93hUDEI.js";import{i as ot}from"../chunks/BznYoFRY.js";import{p as ut,b0 as wt,J as s,K as n,I as v,G as q,x as f,B as R,a as vt,o as Nt,b1 as V,b2 as jt,F as kt,A as t,aF as mt,aH as r,at as p,a3 as Ft,ap as it}from"../chunks/DcTAzX_I.js";import{s as S}from"../chunks/hnOH0-N2.js";import{s as nt,b as St,T as Ot,e as ht,i as xt}from"../chunks/Ijujpeek.js";import{p as I,i as G,b as Rt,s as Bt,a as Kt}from"../chunks/B944SqXc.js";import{r as zt,s as Ut,l as Jt,a as It,b as yt}from"../chunks/B0dv8mGB.js";import{e as W}from"../chunks/BpqMFE6l.js";import{g as Ct}from"../chunks/DA6Kvlk3.js";var qt=$('<div class="expanded-panel svelte-1fl11k9"><button class="enter-btn-small svelte-1fl11k9">Enter Dojo</button></div>'),Gt=$('<div class="tile-wrapper svelte-1fl11k9"><button class="login-tile svelte-1fl11k9"><div class="login-tile-avatar svelte-1fl11k9"><span class="avatar-initials svelte-1fl11k9"> </span></div> <div class="login-tile-info svelte-1fl11k9"><div class="login-tile-name svelte-1fl11k9"> </div> <div class="belt-pill svelte-1fl11k9"> </div></div></button> <!></div>');function Ht(B,d){ut(d,!1);let g=I(d,"student",8),E=I(d,"index",8),X=I(d,"expanded",8,!1);const y=wt(),w=["#1a2232","#1c2638","#1d293d","#202c42","#1b2635","#1e2b44"],k=["#93c5fd","#a5f3fc","#fda4af","#fcd34d","#bbf7d0","#c7d2fe"];function A(a){return w[a%w.length]}function L(a){return k[a%k.length]}function z(a){const l=a.toLowerCase();return l.includes("white")?"#e5e7eb":l.includes("yellow")?"#facc15":l.includes("orange")?"#fb923c":l.includes("green")?"#22c55e":l.includes("blue")?"#3b82f6":l.includes("purple")?"#a855f7":l.includes("brown")?"#92400e":l.includes("red")?"#dc2626":l.includes("black")?"#111827":"#334155"}function C(a){const l=z(a);return new Set(["#111827","#92400e","#dc2626","#334155"]).has(l)?"#f9fafb":"#111827"}function j(a){return a?a.replace(/^(Mr\.?|Ms\.?|Mrs\.?|Miss|Dr\.?)\s+/i,"").trim().split(/\s+/).map(l=>l[0]).join("").slice(0,2).toUpperCase():""}function u(a){return(a?.displayName||a?.name||"Unknown").toString()}ot();var M=Gt(),c=s(M),b=s(c),m=s(b),F=s(m,!0);n(m),n(b);var N=v(b,2),P=s(N),K=s(P,!0);n(P);var O=v(P,2),T=s(O,!0);n(O),n(N),n(c);var H=v(c,2);{var Z=a=>{var l=qt(),h=s(l);n(l),W("click",h,()=>y("enter")),D(a,l)};G(H,a=>{X()&&a(Z)})}n(M),q((a,l,h,Q,tt,Y,U)=>{nt(c,`background:${a??""};border-color:${l??""};`),nt(b,`background:${h??""};`),S(F,Q),S(K,tt),nt(O,`background:${Y??""};color:${U??""};`),S(T,(R(g()),f(()=>g().rank)))},[()=>(R(E()),f(()=>A(E()))),()=>(R(E()),f(()=>A(E()))),()=>(R(E()),f(()=>L(E()))),()=>(R(g()),f(()=>j(u(g())))),()=>(R(g()),f(()=>u(g()))),()=>(R(g()),f(()=>z(g().rank))),()=>(R(g()),f(()=>C(g().rank)))]),W("click",c,()=>y("toggle")),D(B,M),vt()}var Qt=$('<span class="pill svelte-1ppz18g"> </span>'),Yt=$('<span class="pill is3 svelte-1ppz18g"> </span>'),Vt=$('<p class="pin-error svelte-1ppz18g"> </p>'),Wt=$('<div class="pin-backdrop svelte-1ppz18g"><div class="pin-card svelte-1ppz18g"><div class="avatar svelte-1ppz18g"> </div> <h2 class="pin-title svelte-1ppz18g"> </h2> <p class="pin-subtitle handwritten svelte-1ppz18g"> </p> <div class="pills svelte-1ppz18g"><!> <!></div> <label class="pin-label svelte-1ppz18g" for="pinInput">PIN</label> <input id="pinInput" type="password" class="pin-input svelte-1ppz18g" placeholder="Enter PIN…" maxlength="8"/> <!> <div class="actions svelte-1ppz18g"><button class="btn ghost svelte-1ppz18g">CANCEL</button> <button class="btn ok svelte-1ppz18g">OK</button></div></div></div>');function Et(B,d){ut(d,!1);let g=I(d,"title",8,""),E=I(d,"subtitle",8,""),X=I(d,"value",12,""),y=I(d,"pinField",12,null),w=I(d,"pinError",8,""),k=I(d,"avatarInitials",8,""),A=I(d,"avatarColor",8,""),L=I(d,"rank",8,""),z=I(d,"is3Rank",8,"");const C=wt();function j(){C("cancel")}function u(){C("submit")}Nt(()=>{y()&&(y().focus(),y().select())});function M(o){o.key==="Enter"&&C("submit")}ot();var c=Wt(),b=s(c),m=s(b),F=s(m,!0);n(m);var N=v(m,2),P=s(N,!0);n(N);var K=v(N,2),O=s(K,!0);n(K);var T=v(K,2),H=s(T);{var Z=o=>{var _=Qt(),J=s(_,!0);n(_),q(()=>S(J,L())),D(o,_)};G(H,o=>{L()&&o(Z)})}var a=v(H,2);{var l=o=>{var _=Yt(),J=s(_,!0);n(_),q(()=>S(J,z())),D(o,_)};G(a,o=>{z()&&o(l)})}n(T);var h=v(T,4);zt(h),Rt(h,o=>y(o),()=>y());var Q=v(h,2);{var tt=o=>{var _=Vt(),J=s(_,!0);n(_),q(()=>S(J,w())),D(o,_)};G(Q,o=>{w()&&o(tt)})}var Y=v(Q,2),U=s(Y),et=v(U,2);n(Y),n(b),n(c),q(()=>{nt(m,`background: ${A()??""}`),S(F,k()),S(P,g()),S(O,E())}),St(h,X),W("keydown",h,M),W("click",U,j),W("click",et,u),D(B,c),vt()}var Xt=$('<div class="instructor-tag svelte-8ukb9p">Instructor Mode Enabled</div>'),Zt=$('<div class="letter-header svelte-8ukb9p"> </div> <!>',1),te=$('<div class="login-wrapper svelte-8ukb9p" style="margin-top: 100px;"><section><!> <header class="login-header svelte-8ukb9p"><h1 class="login-title svelte-8ukb9p">Enter the Dojo</h1> <p class="login-subtitle svelte-8ukb9p">Tap your profile to begin your training journey.</p></header> <!> <div class="login-toolbar svelte-8ukb9p"><input type="text" class="login-search svelte-8ukb9p" placeholder="Search students…"/> <div class="instructor-switch svelte-8ukb9p"><button type="button" aria-label="Toggle Instructor Login"><span class="instructor-thumb svelte-8ukb9p"></span></button> <span class="instructor-label svelte-8ukb9p">Instructor Login</span></div></div> <div class="login-roster-scroll svelte-8ukb9p"><div class="login-grid svelte-8ukb9p"></div></div></section></div> <!> <!>',1);function ee(B,d){ut(d,!1);const g=()=>Kt(Ut,"$students",E),[E,X]=Bt(),y=p();let w=p(""),k=p(!1),A=p([]),L=p([]),z=p([]),C=p({}),j=p(null),u=p(null),M=p(0),c=p(!1),b=p(!1),m=p(""),F=p(""),N=p(""),P=p("");const K="8675309";let O=null;const T=["#93c5fd","#a5f3fc","#fda4af","#fcd34d","#bbf7d0","#c7d2fe"];function H(e){return e==null?T[0]:T[e%T.length]}function Z(e){return e?e.replace(/^(Mr\.?|Ms\.?|Mrs\.?|Miss|Dr\.?)\s+/i,"").trim().split(/\s+/).map(i=>i[0]).join("").slice(0,2).toUpperCase():""}function a(e){const x=(e?.displayName||e?.name||"").toString().trim().split(/\s+/).filter(Boolean);return x.length===0?"":x[x.length-1].toUpperCase()}function l(e){r(j,t(j)===e?null:e)}function h(e,i){r(u,e),r(M,i??0),t(k)?(yt(e),Ct("/student-dashboard/dashboard")):(r(c,!0),r(m,""),r(N,""))}function Q(){t(u)&&(t(m)===(t(u).pin??"")?(yt(t(u)),r(c,!1),Ct("/student-dashboard/dashboard")):r(N,"Incorrect PIN — try again."))}Nt(()=>{Jt().catch(e=>console.error("Failed to load students:",e))});function tt(){if(t(k)){r(k,!1);return}r(F,""),r(P,""),r(b,!0)}function Y(){t(F)===K?(r(k,!0),r(b,!1)):r(P,"Invalid admin PIN.")}V(()=>g(),()=>{r(A,g()||[])}),V(()=>(t(A),t(w)),()=>{r(L,t(A).filter(e=>`${e?.name||""} ${e?.displayName||""}`.toLowerCase().includes(t(w).toLowerCase()))||[])}),V(()=>t(L),()=>{r(z,[...t(L)].sort((e,i)=>a(e).localeCompare(a(i))))}),V(()=>t(z),()=>{r(C,t(z).reduce((e,i)=>{const x=a(i)[0];return e[x]||(e[x]=[]),e[x].push(i),e},{}))}),V(()=>(t(c),t(b),mt),()=>{(t(c)||t(b))&&mt().then(()=>{})}),V(()=>t(k),()=>{r(y,t(k)?"instructor-active":"")}),jt(),ot();var U=te(),et=kt(U),o=s(et),_=s(o);{var J=e=>{var i=Xt();D(e,i)};G(_,e=>{t(k)&&e(J)})}var dt=v(_,4);Ot(dt,{});var st=v(dt,2),lt=s(st);zt(lt);var ct=v(lt,2),pt=s(ct);Ft(2),n(ct),n(st);var ft=v(st,2),gt=s(ft);ht(gt,5,()=>(t(C),f(()=>Object.keys(t(C)))),xt,(e,i)=>{var x=Zt(),at=kt(x),Dt=s(at);n(at);var $t=v(at,2);ht($t,1,()=>(t(C),t(i),f(()=>t(C)[t(i)])),xt,(At,rt,_t)=>{{let Lt=it(()=>(t(j),t(rt),f(()=>t(j)===t(rt).id)));Ht(At,{get student(){return t(rt)},index:_t,get expanded(){return t(Lt)},$$events:{toggle:()=>l(t(rt).id),enter:()=>h(t(rt),_t)}})}}),q(()=>S(Dt,`— ${t(i)??""} —`)),D(e,x)}),n(gt),n(ft),n(o),n(et);var bt=v(et,2);{var Mt=e=>{{let i=it(()=>(t(u),f(()=>Z(t(u).displayName)))),x=it(()=>(t(M),f(()=>H(t(M)))));Et(e,{title:"Enter Your PIN",get subtitle(){return t(u),f(()=>t(u).displayName)},pinField:O,get pinError(){return t(N)},get avatarInitials(){return t(i)},get avatarColor(){return t(x)},get rank(){return t(u),f(()=>t(u).rank)},get is3Rank(){return t(u),f(()=>t(u).is3Rank)},get value(){return t(m)},set value(at){r(m,at)},$$events:{submit:Q,cancel:()=>r(c,!1)},$$legacy:!0})}};G(bt,e=>{t(c)&&t(u)&&e(Mt)})}var Pt=v(bt,2);{var Tt=e=>{Et(e,{title:"Instructor Access",subtitle:"Enter the Dojo Admin PIN.",pinField:O,get pinError(){return t(P)},avatarInitials:"TK",avatarColor:"#38bdf8",rank:"",is3Rank:"",get value(){return t(F)},set value(i){r(F,i)},$$events:{submit:Y,cancel:()=>r(b,!1)},$$legacy:!0})};G(Pt,e=>{t(b)&&e(Tt)})}q(()=>{It(o,1,`login-card ${t(y)??""}`,"svelte-8ukb9p"),It(pt,1,"instructor-toggle "+(t(k)?"is-on":""),"svelte-8ukb9p")}),St(lt,()=>t(w),e=>r(w,e)),W("click",pt,tt),D(B,U),vt(),X()}function de(B){ee(B,{})}export{de as component};
